<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Excel -> Chart Demo</title>
  <link rel="stylesheet" href="style.css" />
  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <!-- SheetJS (xlsx) CDN -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
</head>
<body>
  <main>
    <h1>Excel-Daten visualisieren (VIBE Coding Demo)</h1>

    <section class="controls">
      <label>
        Excel-Datei (.xlsx oder .xls)
        <input id="fileInput" type="file" accept=".xlsx,.xls,.csv" />
      </label>

      <label>
        <input id="headerRow" type="checkbox" checked />
        Erste Zeile enthält Spaltennamen
      </label>

      <label>
        Blatt:
        <select id="sheetSelect"></select>
      </label>

      <label>
        Datei aus Repo (data/):
        <select id="repoFileSelect"></select>
      </label>

      <div style="display:flex;gap:8px;align-items:center;">
        <button id="refreshRepoFiles">Repo-Dateien aktualisieren</button>
        <button id="loadRepoFileBtn" disabled>Aus Repo laden</button>
      </div>

      <label>
        X-Achse (Labels):
        <select id="xSelect"></select>
      </label>

      <label>
        Y-Achse (Werte — mehrere möglich):
        <select id="ySelect" multiple size="4"></select>
      </label>

      <label>
        Chart-Typ:
        <select id="chartType">
          <option value="line">Line</option>
          <option value="bar">Bar</option>
          <option value="pie">Pie</option>
          <option value="doughnut">Doughnut</option>
        </select>
      </label>

      <div class="buttons">
        <button id="renderBtn" disabled>Visualisieren</button>
        <button id="downloadPNGBtn" disabled>Als PNG herunterladen</button>
      </div>
    </section>

    <section class="chart-area">
      <canvas id="chartCanvas"></canvas>
    </section>

    <section class="notes">
      <h2>Hinweis</h2>
      <p>Die App versucht beim Laden automatisch die Excel-Dateien aus dem Ordner <code>data/</code> deines Repos zu lesen (Branch: <code>Main</code> oder <code>main</code>).</p>
      <p>Wenn dein Repo privat ist, oder CORS/Authorization-Fehler auftreten, poste bitte die Fehlermeldung aus der Browser-Konsole — ich helfe beim Anpassen.</p>
    </section>
  </main>

  <script src="app.js"></script>
</body>
</html>
